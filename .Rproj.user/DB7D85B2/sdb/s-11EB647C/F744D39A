{
    "collab_server" : "",
    "contents" : "### downloading and unzipping Essex Police data\n#devtools::install_github(\"dkahle/ggmap\")\ndevtools::install_github(\"hadley/ggplot2\")\n\ninstall.packages(\"ggplot2\")\ninstall.packages(\"ggmap\", type = \"source\")\n\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(stringr)\nlibrary(ggmap)\nlibrary(ggplot2)\n\n??ggproto\n\n#files <- list.files(recursive = T, pattern = \"*.csv\")\nfiles <- dir(recursive = T, pattern = \"*.csv\", full.names=TRUE)\nlondon_files <- dir(recursive = T, pattern = \"*metropolitan-street.csv\", full.names=TRUE)\n\nlondon_police_data <- do.call(rbind,lapply(london_files, read.csv))\nstr(london_police_data)\n\nsort(table(london_police_data$Crime.type))\n\nmap_data <- london_police_data %>%\n  filter(Crime.type == \"Possession of weapons\") %>% \n  #na.omit() %>%\n  select(Month, Longitude, Latitude, Crime.type)\n\nsummary(map_data)\n\nmap_data[is.na(map_data), ] <- NULL\n\n### creating a map ####\nlondon_lon = c(min(map_data$Longitude, na.rm = TRUE), max(map_data$Longitude, na.rm = TRUE)) \nlondon_lat = c(min(map_data$Latitude, na.rm = TRUE), max(map_data$Latitude, na.rm = TRUE)) \n\n?get_map\n\nlondon_map = get_map(location = \"London\",\n                       maptype=\"toner\",  zoom = 10)\n\nggmap(london_map)\n\n\n#### plotting points / creating heatmap ####\n\n#### weapon possession\n??panel.spacing\n\nlondon_heat_map<- ggmap(london_map, extent = \"device\") +\n  stat_density_2d(aes(x = Longitude, y = Latitude, fill = ..level.., alpha=1),\n                  data=map_data, geom = \"polygon\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_alpha(range = c(0.00, 0.5), guide = FALSE) \n  #scale_x_continuous(limits = essex_lon) +\n  #scale_y_continuous(limits = essex_lat) \n\nlondon_heat_map\n\n\n#### animated maps \n\ndevtools::install_github(\"thomasp85/tweenr\")\nlibrary(tweenr)\n\nweapons_1 <- map_data %>% filter(Month == '2016-01')\nweapons_2 <- map_data %>% filter(Month == '2016-02')\nweapons_3 <- map_data %>% filter(Month == '2016-03')\nweapons_4 <- map_data %>% filter(Month == '2016-04')\nweapons_5 <- map_data %>% filter(Month == '2016-05')\nweapons_6 <- map_data %>% filter(Month == '2016-06')\nweapons_7<- map_data %>% filter(Month == '2016-07')\nweapons_8 <- map_data %>% filter(Month == '2016-08')\nweapons_9 <- map_data %>% filter(Month == '2016-09')\nweapons_10 <- map_data %>% filter(Month == '2016-10')\nweapons_11 <- map_data %>% filter(Month == '2016-11')\nweapons_12 <- map_data %>% filter(Month == '2016-12')\nweapons_13 <- map_data %>% filter(Month == '2017-01')\nweapons_14 <- map_data %>% filter(Month == '2017-02')\nweapons_15 <- map_data %>% filter(Month == '2017-03')\n\n?tween_states\n\ndata <- tween_states(list(paste0(\"weapons_\",1:15)), 3, 1, 'cubic-in-out', 100)\n\n\n##### example \nlibrary(tweenr)\n\ngapminder_edit <- gapminder %>%\n  arrange(country, year) %>%\n  select(gdpPercap,lifeExp,year,country, continent, pop) %>%\n  rename(x=gdpPercap,y=lifeExp,time=year,id=country) %>%\n  mutate(ease=\"linear\")\n\ngapminder_tween <- tween_elements(gapminder_edit,\n                                  \"time\", \"id\", \"ease\", nframes = 300) %>%\n  mutate(year = round(time), country = .group) %>%\n  left_join(gapminder, by=c(\"country\",\"year\",\"continent\")) %>%\n  rename(population = pop.x)\n\np2 <- ggplot(gapminder_tween,\n             aes(x=x, y=y, frame = .frame)) +\n  geom_point(aes(size=population, color=continent),alpha=0.8) +\n  xlab(\"GDP per capita\") +\n  ylab(\"Life expectancy at birth\") +\n  scale_x_log10(labels=comma)\n\ngganimate(p2, filename=\"gapminder-tween.gif\", title_frame = FALSE, interval = 0.05)\nFor another nice example using the tweenr package, check out this blog post by Jake \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1495396810544.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "136588029",
    "id" : "F744D39A",
    "lastKnownWriteTime" : 1495749184,
    "last_content_update" : 1495749184445,
    "path" : "~/projects/animated_maps/uk_police_animation.R",
    "project_path" : "uk_police_animation.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}